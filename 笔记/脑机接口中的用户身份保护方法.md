[原文链接]("User Identity Protection in EEG-based Brain-Computer Interfaces孟璐斌等")
# 零、摘要
**现状**：目前大部分脑机接口中脑电信号的研究关注于对于EEG信号的解码，但是脑电信号中蕴含正丰富的脑电信息。
**问题**：<u>EEG信号中的用户身份可以很容易地被学习到</u>，这样来自同一用户的不同时段的EEG数据就可以关联在一起，更可靠地挖掘私人信息。
**解决方式**：提出了两种生成数据扰动：用户级数据扰动和样本级数据扰动，使得原来的EEG信号变为身份不可学习EEG信号，**移除用户身份信息**的同时**保持高的原始BCI任务准确性**。

# 一、引言
*隐私保护方法*：
	1. 匿名化（简单匿名化并不能消除用户身份，原文P2）
	2. 数据消毒
	3. 密码学方法（HE、SMC、cure processors）
	4. 隐私保护机器学习(联邦学习、无数据迁移、教师系统)
	5. **基于扰动的方法**（差分隐私、数据重建）--本文方法

# 二、方法
训练过程优化损失，细节，问题描述：
<center>
<img src="https://img2023.cnblogs.com/blog/2812800/202308/2812800-20230801103451918-45390927.jpg" /style="zoom:33%;transform:rotate(270deg)"/> </center>

*样本级扰动和用户级扰动生成伪代码：*
<center class="half"> 
<img src="https://img2023.cnblogs.com/blog/2812800/202308/2812800-20230801104744991-1992929650.png" width = 310 align = left><img src="https://img2023.cnblogs.com/blog/2812800/202308/2812800-20230801104803778-1901969168.png" width = 330 align = right>
</center>

# 三、实验设置
#### 数据集-四种实验范式七个EEG信号数据集：
1. MI1
2. MI2
3. P300
4. Feedback error-related negativity（ERN）
5. SSVEP
6. Neonatal seizures (NS) 
7. The Temple University Hospital EEG Seizure Corpus (TUSZ)
#### 模型
**特征提取器**：
下列CNN模型，均去除最后一个全连接层作为特征提取器
1. EEGNet
2. DeepCNN（其第一个卷积块为EEG信号输入而设计）
3. ShallowCNN（简化版DeepCNN）
**任务相关分类器**：
一层全连接层
**用户分类器**：
两层全连接层
#### 实验设置
**留一交叉验证**（leave-one-session-out cross validation）：
	留出一个session作为训练集（**训练C和D，两个分类器**），其他的sessions作为测试集；假如有S个sessions，则实验重复S次，保证每个session都被用于作为训练集一次
整个实验重复五次，每次取不同的随机数种子
其他：针对于特定数据集特性进行处理
#### 评价指标
***两个评价指标：***
>	1. balanced classification accuracy (**BCA**) :评价分类准确性（有些BCI任务具有严重的类别不平衡性）
>	>计算公式：
>	>	$BCA=\frac{1}{K} \sum_{k=1}^{K} \frac{1}{N_k}\sum_{i=1}^{N_k} \mathbf{1} (y_{pred,i}=k)$  *%1(·)指标函数，取值为0/1*
>	2. user identification accuracy (**UIA**)：评价身份验证指标（评判身份分类器的表现）
>	>计算公式：
>	>	$UIA= \frac{1}{N_t}\sum_{i=1}^{N_t} \mathbf{1} (u_{pred,i}=u_i)$

# 四、实验结果
#### EEG信号中的身份隐私信息
直接使用，在未经扰动数据上训练好的特征提取器和任务相关分类器<u>提取的特征，做用户身份判别试验，实验结果UIAs远高于随机猜测结果</u>
**结论**：丰富的用户身份信息可以从不同BCI范式的EEG数据中得到利用，因此同一用户的不同时段的EEG数据可以准确地关联在一起。
#### 扰动数据对于用户身份的保护
**细节**：EEGNet作为特征提取器，生成样本级和用户级扰动，加入到原始EEG信号中，使之变为身份不可学习数据
**验证**：在扰动的训练EEG数据上训练了一个特征提取器和一个任务分类器，然后用提取的特征来训练一个用户分类器
**结果**：
	==1. 扰动对于原始BCI任务（比如分类）几乎没有影响；
	2. 扰动后，UIAs指标大幅下降，说明扰动后的EEG数据有很强的身份不可学习性==
		*补充*：<u>生成的扰动对于不同的backbone特征提取器均是有效的</u>，减小了在实际实验设置时的难度，**实际上的迁移效果还是要看特征提取模型之间的相似度**
#### 实验结果可视化
验证扰动数据和原始数据几乎没有差别：
![image](https://img2023.cnblogs.com/blog/2812800/202308/2812800-20230801141612422-589406211.png)
**结论**：***以小精度性能下降换来更高的隐私保护安全性***
一些可视化结果：
![image](https://img2023.cnblogs.com/blog/2812800/202308/2812800-20230801141831402-1519639980.png)
![image](https://img2023.cnblogs.com/blog/2812800/202308/2812800-20230801141910887-1576262170.png)
![image](https://img2023.cnblogs.com/blog/2812800/202308/2812800-20230801141942322-1401918440.png)

最后，论证了<u>扰动数据之间的统计学上的意义</u>
**结论**：
>1. 训练过程中，很难发现数据是扰动过的；
>2. 扰动数据的身份信息已经移除
>3. 扰动信息在在线场景下，表现效果也很好
>4. 用户级扰动是针对用户的，也可以作为用户识别的特征。
